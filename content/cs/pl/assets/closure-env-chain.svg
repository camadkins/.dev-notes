<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" type="text/css"?>
<svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 789.6171875 746" style="max-width: 100%; max-height: 100%; background: transparent; color: rgb(51, 51, 51);" class="flowchart" xmlns="http://www.w3.org/2000/svg" width="100%" id="mermaid-image-editor"><style>#mermaid-image-editor{font-family:Inter;font-size:16px;fill:#333;}#mermaid-image-editor .error-icon{fill:hsl(220.5882352941, 100%, 98.3333333333%);}#mermaid-image-editor .error-text{fill:rgb(8.5000000002, 5.7500000001, 0);stroke:rgb(8.5000000002, 5.7500000001, 0);}#mermaid-image-editor .edge-thickness-normal{stroke-width:1px;}#mermaid-image-editor .edge-thickness-thick{stroke-width:3.5px;}#mermaid-image-editor .edge-pattern-solid{stroke-dasharray:0;}#mermaid-image-editor .edge-thickness-invisible{stroke-width:0;fill:none;}#mermaid-image-editor .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-image-editor .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-image-editor .marker{fill:#0b0b0b;stroke:#0b0b0b;}#mermaid-image-editor .marker.cross{stroke:#0b0b0b;}#mermaid-image-editor svg{font-family:Inter;font-size:16px;}#mermaid-image-editor p{margin:0;}#mermaid-image-editor .label{font-family:Inter;color:#333;}#mermaid-image-editor .cluster-label text{fill:rgb(8.5000000002, 5.7500000001, 0);}#mermaid-image-editor .cluster-label span{color:rgb(8.5000000002, 5.7500000001, 0);}#mermaid-image-editor .cluster-label span p{background-color:transparent;}#mermaid-image-editor .label text,#mermaid-image-editor span{fill:#333;color:#333;}#mermaid-image-editor .node rect,#mermaid-image-editor .node circle,#mermaid-image-editor .node ellipse,#mermaid-image-editor .node polygon,#mermaid-image-editor .node path{fill:#fff4dd;stroke:hsl(40.5882352941, 60%, 83.3333333333%);stroke-width:1px;}#mermaid-image-editor .rough-node .label text,#mermaid-image-editor .node .label text,#mermaid-image-editor .image-shape .label,#mermaid-image-editor .icon-shape .label{text-anchor:middle;}#mermaid-image-editor .node .katex path{fill:#000;stroke:#000;stroke-width:1px;}#mermaid-image-editor .rough-node .label,#mermaid-image-editor .node .label,#mermaid-image-editor .image-shape .label,#mermaid-image-editor .icon-shape .label{text-align:center;}#mermaid-image-editor .node.clickable{cursor:pointer;}#mermaid-image-editor .root .anchor path{fill:#0b0b0b!important;stroke-width:0;stroke:#0b0b0b;}#mermaid-image-editor .arrowheadPath{fill:#0b0b0b;}#mermaid-image-editor .edgePath .path{stroke:#0b0b0b;stroke-width:2.0px;}#mermaid-image-editor .flowchart-link{stroke:#0b0b0b;fill:none;}#mermaid-image-editor .edgeLabel{background-color:hsl(-79.4117647059, 100%, 93.3333333333%);text-align:center;}#mermaid-image-editor .edgeLabel p{background-color:hsl(-79.4117647059, 100%, 93.3333333333%);}#mermaid-image-editor .edgeLabel rect{opacity:0.5;background-color:hsl(-79.4117647059, 100%, 93.3333333333%);fill:hsl(-79.4117647059, 100%, 93.3333333333%);}#mermaid-image-editor .labelBkg{background-color:rgba(243.9999999999, 220.9999999998, 255, 0.5);}#mermaid-image-editor .cluster rect{fill:hsl(220.5882352941, 100%, 98.3333333333%);stroke:hsl(220.5882352941, 60%, 88.3333333333%);stroke-width:1px;}#mermaid-image-editor .cluster text{fill:rgb(8.5000000002, 5.7500000001, 0);}#mermaid-image-editor .cluster span{color:rgb(8.5000000002, 5.7500000001, 0);}#mermaid-image-editor div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:Inter;font-size:12px;background:hsl(220.5882352941, 100%, 98.3333333333%);border:1px solid hsl(220.5882352941, 60%, 88.3333333333%);border-radius:2px;pointer-events:none;z-index:100;}#mermaid-image-editor .flowchartTitleText{text-anchor:middle;font-size:18px;fill:#333;}#mermaid-image-editor rect.text{fill:none;stroke-width:0;}#mermaid-image-editor .icon-shape,#mermaid-image-editor .image-shape{background-color:hsl(-79.4117647059, 100%, 93.3333333333%);text-align:center;}#mermaid-image-editor .icon-shape p,#mermaid-image-editor .image-shape p{background-color:hsl(-79.4117647059, 100%, 93.3333333333%);padding:2px;}#mermaid-image-editor .icon-shape rect,#mermaid-image-editor .image-shape rect{opacity:0.5;background-color:hsl(-79.4117647059, 100%, 93.3333333333%);fill:hsl(-79.4117647059, 100%, 93.3333333333%);}#mermaid-image-editor :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}#mermaid-image-editor .env&gt;*{fill:#eef7ff!important;color:#111!important;stroke:#84c0ff!important;}#mermaid-image-editor .env span{fill:#eef7ff!important;color:#111!important;stroke:#84c0ff!important;}#mermaid-image-editor .env tspan{fill:#111!important;}#mermaid-image-editor .envcall&gt;*{fill:#e8f5e9!important;color:#111!important;stroke:#a3d3a7!important;}#mermaid-image-editor .envcall span{fill:#e8f5e9!important;color:#111!important;stroke:#a3d3a7!important;}#mermaid-image-editor .envcall tspan{fill:#111!important;}#mermaid-image-editor .closure&gt;*{fill:#0b5ed7!important;color:#fff!important;stroke:#083b8a!important;}#mermaid-image-editor .closure span{fill:#0b5ed7!important;color:#fff!important;stroke:#083b8a!important;}#mermaid-image-editor .closure tspan{fill:#fff!important;}#mermaid-image-editor .callbox&gt;*{fill:#2e7d32!important;color:#fff!important;stroke:#1b5e20!important;}#mermaid-image-editor .callbox span{fill:#2e7d32!important;color:#fff!important;stroke:#1b5e20!important;}#mermaid-image-editor .callbox tspan{fill:#fff!important;}#mermaid-image-editor .note&gt;*{fill:#fffcef!important;color:#7a6b00!important;stroke:#ffe08a!important;}#mermaid-image-editor .note span{fill:#fffcef!important;color:#7a6b00!important;stroke:#ffe08a!important;}#mermaid-image-editor .note tspan{fill:#7a6b00!important;}</style><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid-image-editor_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid-image-editor_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid-image-editor_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid-image-editor_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid-image-editor_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid-image-editor_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"><g data-look="classic" id="PROG" class="cluster"><rect height="152" width="474.84375" y="8" x="8" style=""></rect><g transform="translate(217.8671875, 8)" class="cluster-label"><foreignObject height="24" width="55.109375"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>Program</p></span></div></foreignObject></g></g><g data-look="classic" id="ENVS" class="cluster"><rect height="504" width="462.8515625" y="234" x="23.765625" style=""></rect><g transform="translate(210.30859375, 234)" class="cluster-label"><foreignObject height="24" width="89.765625"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>Environments</p></span></div></foreignObject></g></g></g><g class="edgePaths"><path marker-end="url(#mermaid-image-editor_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_F_0" d="M143.031,123L143.031,129.167C143.031,135.333,143.031,147.667,143.031,160C143.031,172.333,143.031,184.667,143.031,197C143.031,209.333,143.031,221.667,143.031,240.5C143.031,259.333,143.031,284.667,143.031,312C143.031,339.333,143.031,368.667,146.398,388.929C149.766,409.191,156.5,420.382,159.867,425.977L163.234,431.573"></path><path marker-end="url(#mermaid-image-editor_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_CS_GC_1" d="M370.453,135L370.453,139.167C370.453,143.333,370.453,151.667,370.453,162C370.453,172.333,370.453,184.667,370.453,197C370.453,209.333,370.453,221.667,370.453,231.333C370.453,241,370.453,248,370.453,251.5L370.453,255"></path><path marker-end="url(#mermaid-image-editor_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link" id="L_GC_F_2" d="M331.058,361L326.294,367.167C321.531,373.333,312.004,385.667,298.568,397.63C285.132,409.592,267.787,421.185,259.115,426.981L250.443,432.777"></path><path marker-end="url(#mermaid-image-editor_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_F_G_3" d="M188.766,513L188.766,519.167C188.766,525.333,188.766,537.667,188.766,549.333C188.766,561,188.766,572,188.766,577.5L188.766,583"></path><path marker-end="url(#mermaid-image-editor_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_GC_R_4" d="M398.319,361L401.688,367.167C405.058,373.333,411.796,385.667,433.444,397.793C455.092,409.92,491.649,421.84,509.928,427.8L528.206,433.76"></path></g><g class="edgeLabels"><g transform="translate(143.03125, 310)" class="edgeLabel"><g transform="translate(-53.53125, -12)" class="label"><foreignObject height="24" width="107.0625"><div class="labelBkg" xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"><p>captures env of f</p></span></div></foreignObject></g></g><g transform="translate(370.453125, 197)" class="edgeLabel"><g transform="translate(-70.921875, -12)" class="label"><foreignObject height="24" width="141.84375"><div class="labelBkg" xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"><p>creates env for g(y=5)</p></span></div></foreignObject></g></g><g transform="translate(302.4765625, 398)" class="edgeLabel"><g transform="translate(-62.875, -12)" class="label"><foreignObject height="24" width="125.75"><div class="labelBkg" xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"><p>lexical lookup for x</p></span></div></foreignObject></g></g><g transform="translate(188.765625, 550)" class="edgeLabel"><g transform="translate(-30.8828125, -12)" class="label"><foreignObject height="24" width="61.765625"><div class="labelBkg" xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"><p>outer link</p></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div class="labelBkg" xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(188.765625, 650)" id="flowchart-G-1359" class="node default env"><rect height="126" width="260" y="-63" x="-130" style="fill:#eef7ff !important;stroke:#84c0ff !important" class="basic label-container"></rect><g transform="translate(-100, -48)" style="color:#111 !important" class="label"><rect></rect><foreignObject height="96" width="200"><div xmlns="http://www.w3.org/1999/xhtml" style="color: rgb(17, 17, 17) !important; display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;"><span class="nodeLabel" style="color:#111 !important"><p>Global Env<br/>x = 10<br/>function f(x){ return g(y){ x + y } }</p></span></div></foreignObject></g></g><g transform="translate(188.765625, 474)" id="flowchart-F-1360" class="node default env"><rect height="78" width="170.765625" y="-39" x="-85.3828125" style="fill:#eef7ff !important;stroke:#84c0ff !important" class="basic label-container"></rect><g transform="translate(-55.3828125, -24)" style="color:#111 !important" class="label"><rect></rect><foreignObject height="48" width="110.765625"><div xmlns="http://www.w3.org/1999/xhtml" style="color: rgb(17, 17, 17) !important; display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel" style="color:#111 !important"><p>f's lexical env<br/>x = 10 (captured)</p></span></div></foreignObject></g></g><g transform="translate(370.453125, 310)" id="flowchart-GC-1361" class="node default envcall"><rect height="102" width="162.328125" y="-51" x="-81.1640625" style="fill:#e8f5e9 !important;stroke:#a3d3a7 !important" class="basic label-container"></rect><g transform="translate(-51.1640625, -36)" style="color:#111 !important" class="label"><rect></rect><foreignObject height="72" width="102.328125"><div xmlns="http://www.w3.org/1999/xhtml" style="color: rgb(17, 17, 17) !important; display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel" style="color:#111 !important"><p>g call env<br/>y = 5<br/>x = ? (not local)</p></span></div></foreignObject></g></g><g transform="translate(143.03125, 84)" id="flowchart-C-1362" class="node default closure"><rect height="78" width="200.0625" y="-39" x="-100.03125" style="fill:#0b5ed7 !important;stroke:#083b8a !important" class="basic label-container"></rect><g transform="translate(-70.03125, -24)" style="color:#fff !important" class="label"><rect></rect><foreignObject height="48" width="140.0625"><div xmlns="http://www.w3.org/1999/xhtml" style="color: rgb(255, 255, 255) !important; display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel" style="color:#fff !important"><p>Closure f<br/>(code + captured env)</p></span></div></foreignObject></g></g><g transform="translate(370.453125, 84)" id="flowchart-CS-1363" class="node default callbox"><rect height="102" width="154.78125" y="-51" x="-77.390625" style="fill:#2e7d32 !important;stroke:#1b5e20 !important" class="basic label-container"></rect><g transform="translate(-47.390625, -36)" style="color:#fff !important" class="label"><rect></rect><foreignObject height="72" width="94.78125"><div xmlns="http://www.w3.org/1999/xhtml" style="color: rgb(255, 255, 255) !important; display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel" style="color:#fff !important"><p>Call site<br/>const g = f(10)<br/>g(5)</p></span></div></foreignObject></g></g><g transform="translate(651.6171875, 474)" id="flowchart-R-1372" class="node default note"><rect height="78" width="260" y="-39" x="-130" style="fill:#fffcef !important;stroke:#ffe08a !important" class="basic label-container"></rect><g transform="translate(-100, -24)" style="color:#7a6b00 !important" class="label"><rect></rect><foreignObject height="48" width="200"><div xmlns="http://www.w3.org/1999/xhtml" style="color: rgb(122, 107, 0) !important; display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;"><span class="nodeLabel" style="color:#7a6b00 !important"><p>Inside g: x = 10 (from f),y = 5 (local) → g(5) = 15</p></span></div></foreignObject></g></g></g></g></g></svg>